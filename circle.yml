machine:
  ruby:
    version: "2.4.1"
  node:
    version: "8"
dependencies:
  pre:
    - git clone https://github.com/contentful/the-example-app-e2e-tests.git ./spec/e2e
    - cd ./spec/e2e && npm install
    - gem install foreman
test:
  post:
    - foreman start:
        background: true
    - sleep 5
    - ./spec/e2e/node_modules/.bin/cypress run
    - tar -czf $CIRCLE_ARTIFACTS/cypress-result_`date +%Y-%m-%d_%H-%M-%S`.tar.gz ./cypress
